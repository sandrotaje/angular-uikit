angular.module("angularUikit",[]).directive("ukAutocomplete",function(a,b){return{restrict:"A",require:"ngModel",scope:{ukSource:"=",ukLabel:"=",ukTemplate:"=",ukOnSelect:"&"},link:function(a,c,d,e){var f=a.ukTemplate?a.ukTemplate:'<ul class="uk-nav uk-nav-autocomplete uk-autocomplete-results">{{~items}}<li data-id="{{$item.id}}" data-value="{{$item.value}}"><a>{{$item.value}}</a></li>{{/items}}</ul>',g=[];a.ukSource?a.ukSource.forEach(function(b,c){var d;d=a.ukLabel&&b.hasOwnProperty(a.ukLabel)?b[a.ukLabel]:"string"==typeof b||b instanceof String?b:"Label missing!",g.push({id:c,value:d})}):g.push({id:void 0,value:"No source detected!"});var h=UIkit.autocomplete(c.parent(),{source:g,minLength:1,delay:0,template:f});a.model={},e.$render=function(){var b=e.$viewValue;b?(c.val(b.value),a.model.id=b.id,a.model.value=b.value):(a.model={},c.val(""))},a.$watch("model.id + model.name",function(){e.$setViewValue({id:a.model.id,value:a.model.value})}),e.$formatters=[function(a){return a}],e.$parsers.unshift(function(b){if(b instanceof Object)return a.ukSource[b.id]}),c.off("change"),h.on("selectitem.uk.autocomplete",function(c,d,f){d&&(e.$setViewValue({id:d.id,value:d.value}),a.ukOnSelect&&b(function(){a.ukOnSelect({$selectedItem:a.ukSource[d.id]})}))}),c.on("blur",function(){e.$modelValue||(c.val(""),e.$setViewValue(void 0))})}}}).directive("ukPagination",function(){return{restrict:"AE",scope:{listSize:"=",pageSize:"=",onPageChange:"="},link:function(a,b,c){var d={items:a.listSize,itemsOnPage:a.pageSize,currentPage:0,displayedPages:3,edges:1},e=UIkit.pagination(b,d);window.pag=e,b.on("select.uk.pagination",function(b,c){a.onPageChange(c)}),a.$watch("listSize",function(){e.options.items=a.listSize,e.pages=Math.ceil(a.listSize/a.pageSize),e.render()}),a.$watch("pageSize",function(){e.options.itemsOnPage=a.pageSize,e.pages=Math.ceil(a.listSize/a.pageSize),e.render()})}}}).directive("ukJsonTableForm",function(a){function b(a,b,c){var d='<form name="newItemForm" class="uk-form uk-form-stacked" novalidate><fieldset><table class="uk-table uk-table-striped">';return d+="<thead><tr>",d+='<th data-ng-repeat="h in structure"><span ng-hide="h.type==\'array\' && model.length<=0">{{h.label}}</span></th>',d+="<th></th></tr></thead>",d+="<tbody>",d+="<tr>",b.forEach(function(a){d+="array"!=a.type?'<td><input data-ng-model="newItem.'+a.property+'" type="'+a.type+'" class="uk-width-1-1" placeholder="" title="" required></td>':"<td></td>"}),d+='<td><button class="uk-button uk-button-primary uk-button-small uk-float-right" ng-disabled="newItemForm.$invalid" ng-click="addItem()">{{"ADD" | translate}}</button></td>',d+="</tr>",d+='<tr data-ng-repeat="m in model track by $index">',d+='<td class="uk-table-middle" data-ng-repeat="s in structure">',d+="<div ng-if=\"s.type!='array'\">{{m[s.property]}}</div>",d+='<div ng-if="s.type==\'array\'" uk-json-table-form data-model="m[s.property]" structure="s.items"></div>',d+="</td>",d+='<td class="uk-table-middle"><div class="uk-float-right"><button type="button" ng-click="removeItem($index)" class="uk-button uk-button-danger uk-button-small"><i class="uk-icon-trash"></i></button></div></td>',d+="</tr>",d+="</tbody>",d+="</table></fieldset></form>"}return{restrict:"EA",scope:{model:"=",structure:"="},link:function(c,d,e){c.model||(c.model=[]);var f=b(c.model,c.structure,"first");d.append(a(angular.element(f))(c)),c.addItem=function(){c.model.push(angular.copy(c.newItem)),c.newItem={}},c.removeItem=function(b){c.model.splice(b,1)},c.generateTable=b}}});